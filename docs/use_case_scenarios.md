# 典型的なユースケースシナリオ

## 設計案に基づくユースケース定義

設計書 `what-definition.md` に記載されている典型的なワークフローを基にした、実世界でのユースケースシナリオを定義します。

---

## ユースケース1: 市場調査レポート作成（基本ワークフロー）

### シナリオ概要
企業の企画部門担当者が、新規事業検討のための競合他社の市場調査レポートを作成したい。

### 前提条件
- ユーザーは特定の業界（例：生成AI技術領域）に関する包括的な調査を必要としている
- 技術動向と市場動向の両方を含む詳細なレポートが必要
- 週次での進捗報告が求められている

### ヒアリング結果
```markdown
# ユーザー要望ヒアリング結果

## 基本情報
- 担当者: 企画部 田中様
- プロジェクト: 生成AI事業参入検討
- 期限: 2週間後
- 用途: 経営会議での事業提案

## 調査要件
- **対象領域**: 生成AI技術（特にマルチモーダルAI）
- **調査範囲**: 
  - 技術動向（最新の研究開発状況）
  - 市場動向（市場規模、成長予測）
  - 競合他社分析（主要プレイヤー3-5社）
  - 参入障壁と機会分析
- **成果物**: 
  - PowerPoint用のサマリー（10-15ページ）
  - 詳細調査レポート（30-50ページ）
  - データ表・グラフ集

## 進捗管理要件
- 週次進捗報告（毎週金曜日）
- 中間チェックポイント（1週間後）
- 最終レビュー（提出2日前）

## 参考情報
- 過去に実施した類似調査: AIチャットボット市場調査（2023年）
- 参考にしたい報告書: McKinsey AI Report 2024
- 予算制約: 外部調査会社への委託は不可
```

### ユーザー指示
「生成AI技術、特にマルチモーダルAIの市場調査レポートを作成したい。技術動向、市場規模、競合他社分析を含む包括的な調査をお願いします。まずは必要な情報収集から始めてください。」

### 期待される動作フロー

1. **タスク分解**:
   - `info_001`: 生成AI技術動向の情報収集（Web Agent）
   - `info_002`: マルチモーダルAI市場データの収集（Web Agent）  
   - `info_003`: 競合他社情報の収集（Web Agent）
   - `task_001`: 技術動向セクションの作成（Casual Agent、depends on info_001）
   - `task_002`: 市場分析セクションの作成（Casual Agent、depends on info_002）
   - `task_003`: 競合分析セクションの作成（Casual Agent、depends on info_003）
   - `task_004`: 統合レポートの作成（Casual Agent、depends on task_001-003）
   - `task_005`: PowerPoint資料の作成（File Agent、depends on task_004）

2. **依存関係の実行**:
   - 情報収集タスク（info_001-003）が並行実行
   - 各情報収集完了後、対応する分析タスク（task_001-003）が実行
   - 全分析完了後、統合・資料作成タスクが実行

3. **期待される成果物**:
   - 技術動向分析レポート（Markdown形式）
   - 市場分析レポート（Markdown形式）
   - 競合他社分析レポート（Markdown形式）
   - 統合調査レポート（Markdown形式）
   - PowerPoint用サマリー（構成案）

---

## ユースケース2: データ分析レポート作成（技術的ワークフロー）

### シナリオ概要
データサイエンティストが、営業データの分析と予測モデルの構築結果をまとめたレポートを作成したい。

### ヒアリング結果
```markdown
# データ分析プロジェクト要件

## プロジェクト概要
- 目的: Q4売上予測モデルの構築と精度検証
- データ期間: 過去3年間の月次売上データ
- 予測対象: 今四半期（Q4）の月次売上

## 技術要件
- **データ処理**: Python/pandas使用
- **モデリング**: 時系列分析（ARIMA、Prophet）
- **可視化**: matplotlib、seaborn使用
- **精度指標**: RMSE、MAPE、MAE

## 成果物要件
- データ前処理コード
- 探索的データ分析（EDA）
- モデル構築・評価コード  
- 予測結果の可視化
- 技術レポート（手法説明・結果考察）
- 経営層向けサマリー

## データファイル
- sales_data.csv: 月次売上データ
- customer_segments.csv: 顧客セグメント情報
- marketing_spend.csv: マーケティング投資データ
```

### ユーザー指示
「営業データの時系列分析を行い、Q4売上予測モデルを構築したい。データ処理から予測、レポート作成まで一貫して対応してください。まずはデータの前処理と探索的分析から始めてください。」

### 期待される動作フロー

1. **タスク分解**:
   - `task_001`: データ読み込み・前処理コード生成（Coder Agent）
   - `task_002`: 探索的データ分析実行（Coder Agent、depends on task_001）
   - `task_003`: 時系列モデル構築コード生成（Coder Agent、depends on task_002）
   - `task_004`: モデル評価・可視化コード生成（Coder Agent、depends on task_003）
   - `task_005`: 技術レポート作成（Casual Agent、depends on task_004）
   - `task_006`: 経営層向けサマリー作成（Casual Agent、depends on task_005）
   - `task_007`: 分析結果ファイル出力（File Agent、depends on task_004）

---

## ユースケース3: 複合的プロジェクト管理（動的計画更新）

### シナリオ概要
新規Webサービス開発プロジェクトの企画から実装まで、段階的に計画を策定・更新していきたい。

### ヒアリング結果
```markdown
# Webサービス開発プロジェクト

## サービス概要
- サービス名: TaskFlow（仮称）
- 概要: チーム向けタスク管理・進捗可視化サービス
- ターゲット: 中小企業の開発チーム（10-50名）

## フェーズ1要件（企画・調査）
- 市場調査（競合サービス分析）
- 技術選定調査（フロントエンド・バックエンド）
- UI/UXリサーチ
- ビジネスモデル検討

## フェーズ2要件（設計・開発）
- システム設計書作成
- API設計
- フロントエンド開発
- バックエンド開発
- データベース設計

## 制約・要件
- 開発期間: 6ヶ月
- チーム規模: 5名（企画1名、デザイナー1名、エンジニア3名）
- 予算制約: インフラコストを月10万円以内に抑制
- 技術制約: React、Node.js、PostgreSQL使用
```

### ユーザー指示
「新規Webサービス『TaskFlow』の開発プロジェクトを開始したい。まずは企画フェーズから始めて、段階的に計画を立ててください。市場調査と技術選定から始めてもらえますか？」

### 期待される動作（動的計画更新のテスト）

1. **初期フェーズ**:
   - `info_001`: 競合サービス調査（Web Agent）
   - `info_002`: 技術スタック調査（Web Agent）
   - `task_001`: 企画書ドラフト作成（Casual Agent）

2. **動的追加フェーズ**:
   - 初期調査結果に基づいて、追加調査タスクを動的に生成
   - `info_003`: UI/UXベストプラクティス調査（Web Agent）
   - `task_002`: 技術選定レポート作成（Casual Agent）

3. **設計フェーズ移行**:
   - 企画完了後、設計フェーズのタスクを自動生成
   - `task_003`: システム設計書作成（Casual Agent）
   - `task_004`: API設計書作成（Coder Agent）

---

## 受け入れテスト検証ポイント

### 1. タスク分解の妥当性
- ユーザー指示が適切にサブタスクに分解されるか
- 情報参照タスクと作業タスクが正しく分類されるか
- 依存関係（`need`フィールド）が適切に設定されるか

### 2. 依存関係の実行順序
- 依存タスクが完了するまで後続タスクが待機するか
- 並行実行可能なタスクが同時に実行されるか
- 依存タスクの結果が後続タスクに適切に渡されるか

### 3. エージェントの専門性
- Web Agentが情報収集タスクを適切に処理するか
- Casual Agentがレポート作成タスクを適切に処理するか
- Coder Agentがコード生成タスクを適切に処理するか
- File Agentがファイル操作タスクを適切に処理するか

### 4. KVS連携
- ヒアリング結果がタスク計画に反映されるか
- タスクデータが適切にKVSに保存・更新されるか
- セッション管理が正常に機能するか

### 5. 動的計画更新
- 実行中にタスクの追加・変更が可能か
- 計画変更時の整合性が保たれるか

### 6. エラーハンドリング
- LLM APIエラー時のフォールバック動作
- タスク実行失敗時の適切な状態管理
- 部分的な成功時の継続実行能力